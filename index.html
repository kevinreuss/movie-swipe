<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MovieSwipe</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      :root {
        --netflix-red: #ff4d4d;
        --netflix-black: #141414;
        --netflix-dark-gray: #181818;
        --netflix-light-gray: #b3b3b3;
        --netflix-white: #f5f5f1;

        /* Default dark theme variables */
        --background-color: var(--netflix-black);
        --card-background: var(--netflix-dark-gray);
        --text-color: var(--netflix-white);
        --secondary-text-color: var(--netflix-light-gray);
      }

      /* Light theme variables */
      [data-theme="light"] {
        --background-color: #f5f5f5;
        --card-background: #ffffff;
        --text-color: #333333;
        --secondary-text-color: #666666;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Roboto", sans-serif;
      }

      body {
        background-color: var(--background-color);
        color: var(--text-color);
        overflow: hidden;
        height: 100vh;
        width: 100vw;
        position: relative;
      }

      .app-container {
        display: flex;
        flex-direction: column;
        height: 100vh;
        width: 100vw;
        position: relative;
      }

      header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px;
        background-color: rgba(0, 0, 0, 0.8);
        position: fixed;
        top: 0;
        width: 100%;
        z-index: 100;
      }

      /* Add this to make header respond to theme */
      [data-theme="light"] header {
        background-color: rgba(245, 245, 245, 0.9);
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      }

      .logo {
        color: var(--netflix-red);
        font-size: 24px;
        font-weight: bold;
      }

      .header-controls {
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .nav-tabs {
        display: flex;
        justify-content: space-around;
        background-color: var(--netflix-dark-gray);
        position: fixed;
        bottom: 0;
        width: 100%;
        padding: 10px 0;
        z-index: 100;
      }

      /* Add this to make nav tabs respond to theme */
      [data-theme="light"] .nav-tabs {
        background-color: #ffffff;
        box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.1);
      }

      .nav-tab {
        display: flex;
        flex-direction: column;
        align-items: center;
        color: var(--netflix-light-gray);
        text-decoration: none;
        font-size: 12px;
      }

      .nav-tab i {
        font-size: 20px;
        margin-bottom: 5px;
      }

      .nav-tab.active {
        color: var(--netflix-red);
      }

      .swipe-container {
        flex: 1;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 70px 15px 70px 15px;
        position: relative;
        overflow: hidden;
      }

      .card {
        position: absolute;
        width: 90%;
        max-width: 400px;
        height: 75vh;
        max-height: 600px;
        background-color: var(--card-background);
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        touch-action: none;
        transform-origin: center;
        transition: transform 0.3s ease;
        display: flex;
        flex-direction: column;
      }

      .card-image {
        width: 100%;
        height: 45%;
        background-size: cover;
        background-position: center;
        position: relative;
        flex-shrink: 0;
      }

      .card-gradient {
        position: absolute;
        bottom: 0;
        width: 100%;
        height: 50%;
        background: linear-gradient(
          to bottom,
          transparent,
          var(--card-background)
        );
      }

      .card-content {
        padding: 15px;
        flex: 1;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
      }

      .card-title {
        font-size: 24px;
        font-weight: bold;
        margin-bottom: 5px;
      }

      .card-year {
        color: var(--secondary-text-color);
        margin-bottom: 10px;
      }

      .card-description {
        font-size: 14px;
        margin-bottom: 15px;
        line-height: 1.4;
        flex: 1;
        overflow: hidden;
        display: -webkit-box;
        -webkit-line-clamp: 4;
        -webkit-box-orient: vertical;
      }

      .card-platforms {
        display: none;
      }

      .card-genres {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
      }

      .genre-tag {
        background-color: rgba(229, 9, 20, 0.2);
        color: var(--netflix-red);
        padding: 5px 10px;
        border-radius: 15px;
        font-size: 12px;
      }

      .swipe-actions {
        display: none;
      }

      .swipe-hint {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 100px;
        font-weight: bold;
        opacity: 0;
        z-index: 10;
        text-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
      }

      .hint-like {
        color: #26de81;
        right: 10%;
        left: auto;
      }

      .hint-dislike {
        color: #fd5068;
        left: 10%;
        right: auto;
      }

      .hint-maybe {
        color: #1e90ff;
        top: 10%;
      }

      .lists-container {
        flex: 1;
        padding: 70px 15px 70px 15px;
        overflow-y: auto;
        display: none;
      }

      .list-categories {
        display: flex;
        flex-direction: column;
        gap: 20px;
        height: 100%;
        width: 100%;
      }

      .list-category {
        background-color: var(--card-background);
        border-radius: 10px;
        padding: 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
        cursor: pointer;
      }

      .category-info {
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .category-icon {
        font-size: 24px;
      }

      .category-title {
        font-size: 18px;
        font-weight: 500;
      }

      .category-count {
        background-color: var(--netflix-red);
        color: white;
        border-radius: 20px;
        padding: 5px 12px;
        font-size: 14px;
        font-weight: bold;
      }

      .list-detail {
        display: none;
        flex-direction: column;
        height: 100%;
        width: 100%;
      }

      .list-header {
        display: flex;
        align-items: center;
        margin-bottom: 20px;
        gap: 15px;
      }

      .back-button {
        background: none;
        border: none;
        color: var(--text-color);
        font-size: 20px;
        cursor: pointer;
        padding: 5px;
      }

      .list-detail-title {
        font-size: 20px;
        font-weight: 500;
      }

      .list-items {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
        gap: 15px;
      }

      .list-item {
        position: relative;
        border-radius: 5px;
        overflow: hidden;
        box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
      }

      .list-item-image {
        width: 100%;
        aspect-ratio: 2/3;
        background-size: cover;
        background-position: center;
      }

      .list-item-title {
        position: absolute;
        bottom: 0;
        width: 100%;
        padding: 10px;
        background: linear-gradient(to top, rgba(0, 0, 0, 0.9), transparent);
        font-size: 14px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .remove-item {
        position: absolute;
        top: 5px;
        right: 5px;
        background-color: rgba(0, 0, 0, 0.7);
        color: white;
        border: none;
        border-radius: 50%;
        width: 30px;
        height: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        font-size: 14px;
      }

      .empty-list {
        color: var(--netflix-light-gray);
        text-align: center;
        padding: 20px;
      }

      .no-more-cards {
        display: none;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100%;
        text-align: center;
        padding: 20px;
      }

      .no-more-cards i {
        font-size: 50px;
        color: var(--netflix-red);
        margin-bottom: 20px;
      }

      .no-more-cards h2 {
        margin-bottom: 10px;
      }

      .no-more-cards p {
        color: var(--netflix-light-gray);
        margin-bottom: 20px;
      }

      .reset-button {
        background-color: var(--netflix-red);
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        font-weight: bold;
        cursor: pointer;
      }

      .theme-toggle {
        background: none;
        border: none;
        color: var(--text-color);
        font-size: 20px;
        cursor: pointer;
        padding: 5px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      /* Add these styles for the reaction animation */
      .reaction-animation {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(0);
        font-size: 100px;
        z-index: 1000;
        pointer-events: none;
        opacity: 0;
        transition: transform 0.3s ease, opacity 0.3s ease;
      }

      .reaction-animation.active {
        animation: pop-reaction 0.7s ease forwards;
      }

      @keyframes pop-reaction {
        0% {
          transform: translate(-50%, -50%) scale(0);
          opacity: 0;
        }
        50% {
          transform: translate(-50%, -50%) scale(1.2);
          opacity: 1;
        }
        100% {
          transform: translate(-50%, -50%) scale(1);
          opacity: 0;
        }
      }
    </style>
  </head>
  <body>
    <div class="app-container">
      <header>
        <div class="logo">MovieSwipe</div>
        <div class="header-controls">
          <button id="themeToggle" class="theme-toggle">
            <i class="fas fa-moon"></i>
          </button>
        </div>
      </header>

      <div class="swipe-container" id="swipeContainer">
        <!-- Add reaction animation elements -->
        <div class="reaction-animation" id="likeReaction">👍</div>
        <div class="reaction-animation" id="dislikeReaction">👎</div>
        <div class="reaction-animation" id="maybeReaction">🤔</div>

        <div class="no-more-cards">
          <i class="fas fa-film"></i>
          <h2>Keine weiteren Filme</h2>
          <p>Du hast alle verfügbaren Filme und Serien bewertet!</p>
          <button class="reset-button" id="resetButton">
            Von vorne beginnen
          </button>
        </div>

        <!-- Cards will be added here dynamically -->
      </div>

      <div class="lists-container" id="listsContainer">
        <div class="list-categories" id="listCategories">
          <div class="list-category" data-list="liked">
            <div class="category-info">
              <div class="category-icon">👍</div>
              <div class="category-title">Want to watch</div>
            </div>
            <div class="category-count" id="likedCount">0</div>
          </div>

          <div class="list-category" data-list="disliked">
            <div class="category-info">
              <div class="category-icon">👎</div>
              <div class="category-title">Don't want to watch</div>
            </div>
            <div class="category-count" id="dislikedCount">0</div>
          </div>
        </div>

        <div class="list-detail" id="likedDetail">
          <div class="list-header">
            <button class="back-button" data-list="liked">
              <i class="fas fa-arrow-left"></i>
            </button>
            <div class="list-detail-title">👍 Want to watch</div>
          </div>
          <div class="list-items" id="likedList">
            <div class="empty-list">nothing here yet</div>
          </div>
        </div>

        <div class="list-detail" id="dislikedDetail">
          <div class="list-header">
            <button class="back-button" data-list="disliked">
              <i class="fas fa-arrow-left"></i>
            </button>
            <div class="list-detail-title">👎 Don't want to watch</div>
          </div>
          <div class="list-items" id="dislikedList">
            <div class="empty-list">nothing here yet</div>
          </div>
        </div>
      </div>

      <nav class="nav-tabs">
        <a href="#" class="nav-tab active" id="swipeTab">
          <i class="fas fa-film"></i>
          <span>Explore</span>
        </a>
        <a href="#" class="nav-tab" id="listsTab">
          <i class="fas fa-list"></i>
          <span>My Lists</span>
        </a>
      </nav>
    </div>

    <script src="mediaData.js"></script>

    <script>
      // Lists to store user choices (now storing IDs instead of full media objects)
      let likedMediaIds = [];
      let dislikedMediaIds = [];
      let currentQueue = []; // Queue of media to show
      let activeCards = [];

      // DOM Elements
      const swipeContainer = document.getElementById("swipeContainer");
      const listsContainer = document.getElementById("listsContainer");
      const swipeTab = document.getElementById("swipeTab");
      const listsTab = document.getElementById("listsTab");
      const likedList = document.getElementById("likedList");
      const dislikedList = document.getElementById("dislikedList");
      const resetButton = document.getElementById("resetButton");
      const noMoreCards = document.querySelector(".no-more-cards");
      const themeToggle = document.getElementById("themeToggle");

      // Add references to reaction elements
      let likeReaction = document.getElementById("likeReaction");
      let dislikeReaction = document.getElementById("dislikeReaction");
      let maybeReaction = document.getElementById("maybeReaction");

      // Theme handling
      function initTheme() {
        // Check if user has previously set a theme preference
        const savedTheme = localStorage.getItem("theme");

        if (savedTheme) {
          // Apply saved theme
          document.documentElement.setAttribute("data-theme", savedTheme);
          updateThemeIcon(savedTheme);
        } else {
          // Check system preference
          if (
            window.matchMedia &&
            window.matchMedia("(prefers-color-scheme: light)").matches
          ) {
            document.documentElement.setAttribute("data-theme", "light");
            updateThemeIcon("light");
          } else {
            document.documentElement.setAttribute("data-theme", "dark");
            updateThemeIcon("dark");
          }
        }

        // Add event listener for theme toggle
        themeToggle.addEventListener("click", toggleTheme);

        // Listen for system theme changes
        window
          .matchMedia("(prefers-color-scheme: light)")
          .addEventListener("change", (e) => {
            // Only apply system changes if user hasn't set a preference
            if (!localStorage.getItem("theme")) {
              const newTheme = e.matches ? "light" : "dark";
              document.documentElement.setAttribute("data-theme", newTheme);
              updateThemeIcon(newTheme);
            }
          });
      }

      function toggleTheme() {
        const currentTheme =
          document.documentElement.getAttribute("data-theme") || "dark";
        const newTheme = currentTheme === "dark" ? "light" : "dark";

        document.documentElement.setAttribute("data-theme", newTheme);
        localStorage.setItem("theme", newTheme);
        updateThemeIcon(newTheme);
      }

      function updateThemeIcon(theme) {
        if (theme === "dark") {
          themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
        } else {
          themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
        }
      }

      // Initialize the app
      function initApp() {
        // Initialize theme
        initTheme();

        // Initialize the queue of media to show
        refreshQueue();

        // Create initial cards
        createCards();

        // Add event listeners
        swipeTab.addEventListener("click", showSwipeView);
        listsTab.addEventListener("click", showListsView);
        resetButton.addEventListener("click", resetApp);

        // Initialize list handlers
        initListHandlers();
      }

      // Refresh the queue of media to show
      function refreshQueue() {
        // Filter out media that's already in liked or disliked lists
        currentQueue = mediaData
          .filter(
            (media) =>
              !likedMediaIds.includes(media.id) &&
              !dislikedMediaIds.includes(media.id)
          )
          // Shuffle the array to randomize order
          .sort(() => Math.random() - 0.5);
      }

      // Create cards for swiping
      function createCards() {
        // Create 3 cards (or fewer if we're near the end of the queue)
        const numCards = Math.min(3, currentQueue.length);

        for (let i = 0; i < numCards; i++) {
          if (i < currentQueue.length) {
            const media = currentQueue[i];
            const card = createCard(media, i);
            swipeContainer.appendChild(card);
            activeCards.push(card);

            // Only make the top card draggable
            if (i === 0) {
              makeCardDraggable(card);
            }
          }
        }

        // Show "no more cards" if queue is empty
        if (currentQueue.length === 0) {
          noMoreCards.style.display = "flex";
        } else {
          noMoreCards.style.display = "none";
        }

        // Position cards in a stack
        positionCards();
      }

      // Create a single card element
      function createCard(media, queueIndex) {
        const card = document.createElement("div");
        card.className = "card";
        card.dataset.id = media.id;
        card.dataset.queueIndex = queueIndex;

        const genresHTML = media.genres
          .map((genre) => `<div class="genre-tag">${genre}</div>`)
          .join("");

        card.innerHTML = `
          <div class="card-image" style="background-image: url('${media.image}')">
            <div class="card-gradient"></div>
          </div>
          <div class="card-content">
            <div class="card-title">${media.title}</div>
            <div class="card-year">${media.type} • ${media.year}</div>
            <div class="card-description">${media.description}</div>
            <div class="card-genres">${genresHTML}</div>
          </div>
        `;

        return card;
      }

      // Position cards in a stack
      function positionCards() {
        activeCards.forEach((card, index) => {
          card.style.zIndex = 10 - index;
          card.style.transform = `scale(${1 - index * 0.05}) translateY(${
            index * 10
          }px)`;
          card.style.opacity = index === 0 ? "1" : "0.8";
        });
      }

      // Make a card draggable
      function makeCardDraggable(card) {
        let startX, startY, initialX, initialY;
        let isDragging = false;

        // Touch events
        card.addEventListener("touchstart", dragStart, { passive: false });
        card.addEventListener("touchmove", drag, { passive: false });
        card.addEventListener("touchend", dragEnd, { passive: false });

        // Mouse events
        card.addEventListener("mousedown", dragStart);
        card.addEventListener("mousemove", drag);
        card.addEventListener("mouseup", dragEnd);
        card.addEventListener("mouseleave", dragEnd);

        function dragStart(e) {
          e.preventDefault();

          if (e.type === "touchstart") {
            startX = e.touches[0].clientX;
            startY = e.touches[0].clientY;
          } else {
            startX = e.clientX;
            startY = e.clientY;
          }

          initialX = card.getBoundingClientRect().left;
          initialY = card.getBoundingClientRect().top;
          isDragging = true;
        }

        function drag(e) {
          if (!isDragging) return;
          e.preventDefault();

          let currentX, currentY;

          if (e.type === "touchmove") {
            currentX = e.touches[0].clientX;
            currentY = e.touches[0].clientY;
          } else {
            currentX = e.clientX;
            currentY = e.clientY;
          }

          const diffX = currentX - startX;
          const diffY = currentY - startY;

          card.style.transform = `translate(${diffX}px, ${diffY}px) rotate(${
            diffX * 0.1
          }deg)`;
        }

        function dragEnd(e) {
          if (!isDragging) return;
          isDragging = false;

          let currentX, currentY;

          if (e.type === "touchend") {
            currentX = e.changedTouches[0].clientX;
            currentY = e.changedTouches[0].clientY;
          } else {
            currentX = e.clientX;
            currentY = e.clientY;
          }

          const diffX = currentX - startX;
          const diffY = currentY - startY;

          // Determine swipe direction based on distance
          if (diffX > 100) {
            // Swipe right (like)
            card.style.transform = `translate(${window.innerWidth}px, ${diffY}px) rotate(30deg)`;
            setTimeout(() => {
              handleSwipe("like");
            }, 200);
          } else if (diffX < -100) {
            // Swipe left (dislike)
            card.style.transform = `translate(-${window.innerWidth}px, ${diffY}px) rotate(-30deg)`;
            setTimeout(() => {
              handleSwipe("dislike");
            }, 200);
          } else if (diffY < -100) {
            // Swipe up (maybe)
            card.style.transform = `translate(${diffX}px, -${
              window.innerHeight
            }px) rotate(${diffX * 0.1}deg)`;
            setTimeout(() => {
              handleSwipe("maybe");
            }, 200);
          } else {
            // Reset position if not swiped far enough
            card.style.transform = "translate(0, 0) rotate(0)";
          }
        }
      }

      // Handle swipe action
      function handleSwipe(action) {
        if (activeCards.length === 0) return;

        const card = activeCards[0];
        const mediaId = card.dataset.id;
        const media = mediaData.find((m) => m.id == mediaId);

        // Handle based on action
        if (action === "like") {
          likedMediaIds.push(mediaId);
          card.style.transform = "translate(100vw, 0) rotate(30deg)";
          showReaction(likeReaction);
        } else if (action === "dislike") {
          dislikedMediaIds.push(mediaId);
          card.style.transform = "translate(-100vw, 0) rotate(-30deg)";
          showReaction(dislikeReaction);
        } else if (action === "maybe") {
          // Move this item to the end of the queue for later
          currentQueue.push(media);
          card.style.transform = "translate(0, -100vh)";
          showReaction(maybeReaction);
        }

        // Remove card after animation
        setTimeout(() => {
          card.remove();
          activeCards.shift();
          currentQueue.shift();

          // Check if we need to add more cards
          if (
            activeCards.length < 3 &&
            activeCards.length < currentQueue.length
          ) {
            const newQueueIndex = activeCards.length;
            const newMedia = currentQueue[newQueueIndex];
            const newCard = createCard(newMedia, newQueueIndex);
            swipeContainer.appendChild(newCard);
            activeCards.push(newCard);
          }

          // Reposition remaining cards
          positionCards();

          // Make the top card draggable
          if (activeCards.length > 0) {
            makeCardDraggable(activeCards[0]);
          }

          // Check if we've reached the end
          if (currentQueue.length === 0) {
            noMoreCards.style.display = "flex";
          }

          // Update lists view
          updateLists();
        }, 300);
      }

      // Function to show reaction animation
      function showReaction(reactionElement) {
        reactionElement.classList.add("active");

        // Remove the active class after animation completes
        setTimeout(() => {
          reactionElement.classList.remove("active");
        }, 700);
      }

      // Update the lists view
      function updateLists() {
        // Update counts
        document.getElementById("likedCount").textContent =
          likedMediaIds.length;
        document.getElementById("dislikedCount").textContent =
          dislikedMediaIds.length;

        // Update liked list
        if (likedMediaIds.length > 0) {
          likedList.innerHTML = likedMediaIds
            .map((id, index) => {
              const media = mediaData.find((m) => m.id == id);
              return createListItem(media, "liked", index);
            })
            .join("");
        } else {
          likedList.innerHTML =
            '<div class="empty-list">Nothing here yet</div>';
        }

        // Update disliked list
        if (dislikedMediaIds.length > 0) {
          dislikedList.innerHTML = dislikedMediaIds
            .map((id, index) => {
              const media = mediaData.find((m) => m.id == id);
              return createListItem(media, "disliked", index);
            })
            .join("");
        } else {
          dislikedList.innerHTML =
            '<div class="empty-list">Nothing here yet</div>';
        }
      }

      // Create a list item for the lists view
      function createListItem(media, listType, index) {
        return `
          <div class="list-item">
            <div class="list-item-image" style="background-image: url('${media.image}')"></div>
            <div class="list-item-title">${media.title}</div>
            <button class="remove-item" data-list="${listType}" data-index="${index}">
              <i class="fas fa-times"></i>
            </button>
          </div>
        `;
      }

      // Reset the app
      function resetApp() {
        // Clear all cards
        swipeContainer.innerHTML = `
          <div class="reaction-animation" id="likeReaction">👍</div>
          <div class="reaction-animation" id="dislikeReaction">👎</div>
          <div class="reaction-animation" id="maybeReaction">🤔</div>
          <div class="no-more-cards">
            <i class="fas fa-film"></i>
            <h2>Keine weiteren Filme</h2>
            <p>Du hast alle verfügbaren Filme und Serien bewertet!</p>
            <button class="reset-button" id="resetButton">Von vorne beginnen</button>
          </div>
        `;

        // Update reaction element references after rebuilding DOM
        likeReaction = document.getElementById("likeReaction");
        dislikeReaction = document.getElementById("dislikeReaction");
        maybeReaction = document.getElementById("maybeReaction");

        // Reset variables
        likedMediaIds = [];
        dislikedMediaIds = [];
        activeCards = [];

        // Refresh the queue
        refreshQueue();

        // Hide no more cards message
        noMoreCards = document.querySelector(".no-more-cards");
        noMoreCards.style.display = "none";

        // Create new cards
        createCards();

        // Update lists
        updateLists();

        // Add event listener to new reset button
        document
          .getElementById("resetButton")
          .addEventListener("click", resetApp);

        // Switch to swipe view
        swipeTab.click();
      }

      // Show swipe view
      function showSwipeView() {
        // Refresh the queue when returning to swipe view
        refreshQueue();

        // Clear existing cards
        swipeContainer.innerHTML = `
          <div class="reaction-animation" id="likeReaction">👍</div>
          <div class="reaction-animation" id="dislikeReaction">👎</div>
          <div class="reaction-animation" id="maybeReaction">🤔</div>
          <div class="no-more-cards">
            <i class="fas fa-film"></i>
            <h2>Keine weiteren Filme</h2>
            <p>Du hast alle verfügbaren Filme und Serien bewertet!</p>
            <button class="reset-button" id="resetButton">Von vorne beginnen</button>
          </div>
        `;

        // Update reaction element references after rebuilding DOM
        likeReaction = document.getElementById("likeReaction");
        dislikeReaction = document.getElementById("dislikeReaction");
        maybeReaction = document.getElementById("maybeReaction");

        activeCards = [];

        // Create new cards
        createCards();

        // Update UI
        swipeContainer.style.display = "flex";
        listsContainer.style.display = "none";
        swipeTab.classList.add("active");
        listsTab.classList.remove("active");

        // Re-add event listener to reset button
        document
          .getElementById("resetButton")
          .addEventListener("click", resetApp);
      }

      // Show lists view
      function showListsView() {
        swipeContainer.style.display = "none";
        listsContainer.style.display = "flex";
        document.getElementById("listCategories").style.display = "flex";
        document.getElementById("likedDetail").style.display = "none";
        document.getElementById("dislikedDetail").style.display = "none";
        swipeTab.classList.remove("active");
        listsTab.classList.add("active");
      }

      // Add these functions to handle list navigation and item removal
      function initListHandlers() {
        // Category click handlers
        document.querySelectorAll(".list-category").forEach((category) => {
          category.addEventListener("click", function () {
            const listType = this.dataset.list;
            document.getElementById("listCategories").style.display = "none";
            document.getElementById(`${listType}Detail`).style.display = "flex";
          });
        });

        // Back button handlers
        document.querySelectorAll(".back-button").forEach((button) => {
          button.addEventListener("click", function () {
            const listType = this.dataset.list;
            document.getElementById(`${listType}Detail`).style.display = "none";
            document.getElementById("listCategories").style.display = "flex";
          });
        });

        // Set up event delegation for remove buttons
        listsContainer.addEventListener("click", function (e) {
          if (e.target.closest(".remove-item")) {
            const button = e.target.closest(".remove-item");
            const listType = button.dataset.list;
            const index = parseInt(button.dataset.index);

            // Remove the item from the appropriate list
            if (listType === "liked") {
              likedMediaIds.splice(index, 1);
            } else if (listType === "disliked") {
              dislikedMediaIds.splice(index, 1);
            }

            // Refresh the queue to include newly removed items
            refreshQueue();

            // Update the lists
            updateLists();
          }
        });
      }

      // Initialize the app
      initApp();
    </script>
  </body>
</html>
